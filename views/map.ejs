<%- include('partials/header', { title: title }); %>

<h1 class="section-title">Интерактивная карта мира</h1>
<p class="text-center mb-xl">Исследуйте континенты, океаны и страны</p>

<!-- Контейнер для карты -->
<div id="map" style="height: 600px; width: 100%; border-radius: 20px; box-shadow: var(--shadow-lg);"></div>

<!-- Панель управления -->
<div class="map-controls" style="margin-top: 20px; display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
    <button id="btn-satellite" class="btn btn-outline btn-sm"><i class="fas fa-satellite"></i> Спутник</button>
    <button id="btn-map" class="btn btn-outline btn-sm"><i class="fas fa-map"></i> Схема</button>
    <button id="btn-reset" class="btn btn-outline btn-sm"><i class="fas fa-home"></i> Сброс</button>
</div>

<!-- Подключаем Leaflet -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Инициализация карты
        const map = L.map('map').setView([20, 0], 2);

        // Слой карты (OpenStreetMap)
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Спутниковый слой (ESRI World Imagery)
        const satelliteLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
            attribution: '© Esri'
        });

        // Континенты с координатами
        const continents = [
            { name: "Евразия", lat: 50, lng: 100, desc: "Самый большой материк" },
            { name: "Африка", lat: 0, lng: 20, desc: "Самый жаркий" },
            { name: "Северная Америка", lat: 45, lng: -100, desc: "Великие озёра" },
            { name: "Южная Америка", lat: -20, lng: -60, desc: "Амазонка" },
            { name: "Австралия", lat: -25, lng: 135, desc: "Самый сухой" },
            { name: "Антарктида", lat: -80, lng: 0, desc: "Самый холодный" }
        ];

        // Добавляем маркеры
        continents.forEach(c => {
            const marker = L.marker([c.lat, c.lng]).addTo(map);
            marker.bindPopup(`
                <b>${c.name}</b><br>
                ${c.desc}<br>
                <a href="/topics?continent=${c.name}" style="color: #3b82f6;">Узнать больше →</a>
            `);
        });

        // Кнопки управления
        document.getElementById('btn-map').addEventListener('click', () => {
            map.eachLayer(layer => {
                if (layer instanceof L.TileLayer) map.removeLayer(layer);
            });
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
        });

        document.getElementById('btn-satellite').addEventListener('click', () => {
            map.eachLayer(layer => {
                if (layer instanceof L.TileLayer) map.removeLayer(layer);
            });
            satelliteLayer.addTo(map);
        });

        document.getElementById('btn-reset').addEventListener('click', () => {
            map.setView([20, 0], 2);
        });
    });
</script>

<%- include('partials/footer'); %>
